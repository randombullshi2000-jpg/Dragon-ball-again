/**
 * Training Exercise Database
 * Based on the comprehensive training system from the design document
 */

// Exercise categories
const TRAIN_CAT = {
  STRENGTH:  'strength',
  SPEED:     'speed',
  ENDURANCE: 'endurance',
  TECHNIQUE: 'technique',
  KI:        'ki',
  HYBRID:    'hybrid',
  RECOVERY:  'recovery',
};

// Variant tiers
const TRAIN_TIER = {
  BASIC:       'basic',
  FOCUSED:     'focused',
  EXTREME:     'extreme',
  LIMIT_BREAK: 'limitbreak',
};

/**
 * Exercise definition:
 * {
 *   id:        unique string id
 *   name:      display name
 *   cat:       category
 *   desc:      short description
 *   reps:      number of reps (or duration in secs)
 *   stamina:   stamina cost
 *   duration:  real-time seconds
 *   gains:     { stat: baseGain, ... }
 *   requires:  { stat: minValue, ... } | null
 *   tier:      variant tier
 *   injuryRisk: 0-1 probability
 *   unlockAct: story act when available (0=always)
 *   icon:      emoji icon
 *   animation: animation key
 * }
 */

const TRAINING_EXERCISES = [

  // ========================
  // STRENGTH TRAINING
  // ========================

  {
    id: 'pushups',
    name: 'Push-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: '20 standard push-ups. Build chest and arm strength.',
    reps: 20,
    stamina: 30,
    duration: 5,
    gains: { strength: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ’ª',
    animation: 'pushup',
  },
  {
    id: 'pushups_focused',
    name: 'Focused Push-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Slow, controlled push-ups for deeper muscle engagement.',
    reps: 15,
    stamina: 40,
    duration: 5,
    gains: { strength: 0.15 },
    requires: { proficiency_pushups: 3 },
    tier: TRAIN_TIER.FOCUSED,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ’ª',
    animation: 'pushup',
  },
  {
    id: 'pushups_extreme',
    name: 'Extreme Push-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'One-armed alternating push-ups. High injury risk.',
    reps: 10,
    stamina: 50,
    duration: 5,
    gains: { strength: 0.20 },
    requires: { proficiency_pushups: 5 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0.20,
    unlockAct: 0,
    icon: 'ðŸ’ª',
    animation: 'pushup',
  },
  {
    id: 'pushups_limit',
    name: 'Limit Break Push-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: '50 continuous push-ups pushing past your limits. Once per rest.',
    reps: 50,
    stamina: 80,
    duration: 8,
    gains: { strength: 0.40 },
    requires: { proficiency_pushups: 7 },
    tier: TRAIN_TIER.LIMIT_BREAK,
    injuryRisk: 0.40,
    oncePerRest: true,
    unlockAct: 0,
    icon: 'ðŸ”¥',
    animation: 'pushup',
  },

  {
    id: 'boulder_small',
    name: 'Boulder Lifting (50kg)',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Lift and press a large boulder overhead.',
    reps: 10,
    stamina: 35,
    duration: 6,
    gains: { strength: 0.12 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.05,
    unlockAct: 0,
    icon: 'ðŸª¨',
    animation: 'lift',
  },
  {
    id: 'boulder_medium',
    name: 'Boulder Lifting (100kg)',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Heavy boulder press.',
    reps: 8,
    stamina: 50,
    duration: 6,
    gains: { strength: 0.18 },
    requires: { strength: 10 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.10,
    unlockAct: 0,
    icon: 'ðŸª¨',
    animation: 'lift',
  },
  {
    id: 'boulder_large',
    name: 'Boulder Lifting (200kg)',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Massive boulder. Only the strong need apply.',
    reps: 5,
    stamina: 70,
    duration: 8,
    gains: { strength: 0.25 },
    requires: { strength: 20 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.15,
    unlockAct: 1,
    icon: 'ðŸª¨',
    animation: 'lift',
  },
  {
    id: 'boulder_massive',
    name: 'Boulder Lifting (500kg)',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'An absurdly large boulder. Roshi approved.',
    reps: 3,
    stamina: 100,
    duration: 10,
    gains: { strength: 0.40 },
    requires: { strength: 35 },
    tier: TRAIN_TIER.LIMIT_BREAK,
    injuryRisk: 0.25,
    unlockAct: 2,
    icon: 'ðŸª¨',
    animation: 'lift',
  },

  {
    id: 'tree_punch',
    name: 'Tree Punching',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Strike trees to condition fists and build strength.',
    reps: 100,
    stamina: 25,
    duration: 8,
    gains: { strength: 0.08, technique: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.05,
    unlockAct: 0,
    icon: 'ðŸŒ²',
    animation: 'punch',
  },
  {
    id: 'tree_punch_hard',
    name: 'Full-Power Tree Strike',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Maximum power strikes against hardwood trees.',
    reps: 30,
    stamina: 60,
    duration: 8,
    gains: { strength: 0.20, endurance: 0.10 },
    requires: { strength: 15 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0.15,
    unlockAct: 0,
    icon: 'ðŸŒ²',
    animation: 'punch',
  },

  {
    id: 'pullups',
    name: 'Pull-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Build back and arm strength.',
    reps: 10,
    stamina: 35,
    duration: 5,
    gains: { strength: 0.12, endurance: 0.06 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ¤¸',
    animation: 'pullup',
  },
  {
    id: 'pullups_onearm',
    name: 'One-Arm Pull-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Advanced single-arm pull-ups.',
    reps: 3,
    stamina: 70,
    duration: 5,
    gains: { strength: 0.30 },
    requires: { strength: 30 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0.10,
    unlockAct: 1,
    icon: 'ðŸ¤¸',
    animation: 'pullup',
  },
  {
    id: 'muscleup',
    name: 'Muscle-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Pull-up + dip combo for explosive upper body.',
    reps: 5,
    stamina: 80,
    duration: 6,
    gains: { strength: 0.28, technique: 0.15 },
    requires: { strength: 25 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0.10,
    unlockAct: 1,
    icon: 'ðŸ¤¸',
    animation: 'pullup',
  },

  {
    id: 'handstand_pushup',
    name: 'Handstand Push-ups',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Upside-down pressing strength.',
    reps: 8,
    stamina: 45,
    duration: 6,
    gains: { strength: 0.16, technique: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.05,
    unlockAct: 1,
    icon: 'ðŸ™ƒ',
    animation: 'handstand',
  },

  {
    id: 'tire_flip',
    name: 'Tire Flipping (100kg)',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Flip a massive tire for full-body explosive power.',
    reps: 8,
    stamina: 60,
    duration: 7,
    gains: { strength: 0.24, endurance: 0.16 },
    requires: { strength: 20 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.08,
    unlockAct: 1,
    icon: 'ðŸ”„',
    animation: 'lift',
  },

  {
    id: 'log_carry',
    name: 'Log Carrying',
    cat: TRAIN_CAT.STRENGTH,
    desc: 'Carry a heavy log for 100 meters.',
    reps: 100,  // meters
    stamina: 40,
    duration: 8,
    gains: { strength: 0.10, endurance: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸªµ',
    animation: 'carry',
  },

  // ========================
  // SPEED TRAINING
  // ========================

  {
    id: 'sprint_100',
    name: '100m Sprint',
    cat: TRAIN_CAT.SPEED,
    desc: 'Explosive short sprint.',
    reps: 1,
    stamina: 25,
    duration: 3,
    gains: { speed: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸƒ',
    animation: 'run',
  },
  {
    id: 'sprint_interval',
    name: 'Interval Sprints (10Ã—100m)',
    cat: TRAIN_CAT.SPEED,
    desc: 'Ten sprint intervals with minimal rest.',
    reps: 10,
    stamina: 90,
    duration: 20,
    gains: { speed: 0.35 },
    requires: { proficiency_sprint_100: 5 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0.10,
    unlockAct: 1,
    icon: 'ðŸƒ',
    animation: 'run',
  },
  {
    id: 'rabbit_chase',
    name: 'Chase Rabbits',
    cat: TRAIN_CAT.SPEED,
    desc: 'Sprint through forest chasing fast rabbits.',
    reps: 1,
    stamina: 20,
    duration: 5,
    gains: { speed: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ°',
    animation: 'run',
  },
  {
    id: 'agility_course',
    name: 'Agility Course',
    cat: TRAIN_CAT.SPEED,
    desc: 'Navigate an obstacle course at speed.',
    reps: 1,
    stamina: 15,
    duration: 4,
    gains: { speed: 0.08, technique: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'âš¡',
    animation: 'run',
  },
  {
    id: 'dodge_rocks',
    name: 'Dodge Thrown Rocks',
    cat: TRAIN_CAT.SPEED,
    desc: 'Evade projectiles to sharpen reflexes.',
    reps: 20,
    stamina: 20,
    duration: 5,
    gains: { speed: 0.10, technique: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.10,
    unlockAct: 0,
    icon: 'ðŸª¨',
    animation: 'dodge',
  },
  {
    id: 'dodge_multi',
    name: 'Multi-Projectile Dodge',
    cat: TRAIN_CAT.SPEED,
    desc: 'Dodge many projectiles simultaneously.',
    reps: 30,
    stamina: 35,
    duration: 7,
    gains: { speed: 0.18 },
    requires: { speed: 15 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0.20,
    unlockAct: 1,
    icon: 'âš¡',
    animation: 'dodge',
  },
  {
    id: 'forest_jump',
    name: 'Forest Tree Jumping',
    cat: TRAIN_CAT.SPEED,
    desc: 'Leap between tree branches at high speed.',
    reps: 50,
    stamina: 55,
    duration: 8,
    gains: { speed: 0.25, technique: 0.10 },
    requires: { speed: 10 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.10,
    unlockAct: 1,
    icon: 'ðŸŒ²',
    animation: 'jump',
  },

  // ========================
  // ENDURANCE TRAINING
  // ========================

  {
    id: 'situps',
    name: 'Sit-ups',
    cat: TRAIN_CAT.ENDURANCE,
    desc: '20 core-building sit-ups.',
    reps: 20,
    stamina: 25,
    duration: 5,
    gains: { endurance: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ‹ï¸',
    animation: 'situp',
  },
  {
    id: 'squats',
    name: 'Squats',
    cat: TRAIN_CAT.ENDURANCE,
    desc: '20 deep squats for leg and core strength.',
    reps: 20,
    stamina: 28,
    duration: 5,
    gains: { endurance: 0.08, speed: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ¦µ',
    animation: 'squat',
  },
  {
    id: 'run_5k',
    name: '5km Run',
    cat: TRAIN_CAT.ENDURANCE,
    desc: 'Long distance run to build cardiovascular endurance.',
    reps: 1,
    stamina: 50,
    duration: 20,
    gains: { endurance: 0.15 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸƒ',
    animation: 'run',
  },
  {
    id: 'run_10k',
    name: '10km Run',
    cat: TRAIN_CAT.ENDURANCE,
    desc: 'Extended distance run.',
    reps: 1,
    stamina: 85,
    duration: 35,
    gains: { endurance: 0.25 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸƒ',
    animation: 'run',
  },
  {
    id: 'run_marathon',
    name: 'Marathon Run',
    cat: TRAIN_CAT.ENDURANCE,
    desc: 'Full marathon. Pushes endurance to the limit.',
    reps: 1,
    stamina: 150,
    duration: 90,
    gains: { endurance: 0.50 },
    requires: { endurance: 20 },
    tier: TRAIN_TIER.LIMIT_BREAK,
    injuryRisk: 0.15,
    unlockAct: 2,
    icon: 'ðŸ…',
    animation: 'run',
  },
  {
    id: 'horse_stance',
    name: 'Horse Stance',
    cat: TRAIN_CAT.ENDURANCE,
    desc: 'Hold a low horse stance for 5 minutes.',
    reps: 300,  // seconds
    stamina: 45,
    duration: 8,
    gains: { endurance: 0.20 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ§˜',
    animation: 'stance',
  },
  {
    id: 'plank',
    name: 'Plank Hold',
    cat: TRAIN_CAT.ENDURANCE,
    desc: 'Hold plank position for 2 minutes.',
    reps: 120,  // seconds
    stamina: 30,
    duration: 5,
    gains: { endurance: 0.12 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ“',
    animation: 'plank',
  },
  {
    id: 'heavy_bag',
    name: 'Punching Bag (10 min)',
    cat: TRAIN_CAT.ENDURANCE,
    desc: 'Continuous bag work for 10 minutes.',
    reps: 600,
    stamina: 60,
    duration: 12,
    gains: { endurance: 0.20, technique: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 1,
    icon: 'ðŸ¥Š',
    animation: 'punch',
  },
  {
    id: 'waterfall_stand',
    name: 'Waterfall Training',
    cat: TRAIN_CAT.ENDURANCE,
    desc: 'Stand under a rushing waterfall for 10 minutes.',
    reps: 600,
    stamina: 45,
    duration: 12,
    gains: { endurance: 0.20, kiControl: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 1,
    icon: 'ðŸ’§',
    animation: 'stance',
    locationRequired: 'waterfall',
    locationBonus: 0.20,
  },

  // ========================
  // TECHNIQUE TRAINING
  // ========================

  {
    id: 'shadow_box',
    name: 'Shadow Boxing',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: 'Practice punches and footwork against air.',
    reps: 100,
    stamina: 35,
    duration: 10,
    gains: { technique: 0.10, endurance: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ¤œ',
    animation: 'shadowbox',
  },
  {
    id: 'kata_form1',
    name: 'Kata: Rising Sun',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: '20-move kata sequence. Perfect timing for bonus.',
    reps: 1,
    stamina: 30,
    duration: 8,
    gains: { technique: 0.50 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸŒ…',
    animation: 'kata',
    isKata: true,
    qualityThreshold: 0.70,
  },
  {
    id: 'kata_form2',
    name: 'Kata: Flowing Water',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: '30-move kata with complex footwork.',
    reps: 1,
    stamina: 35,
    duration: 10,
    gains: { technique: 0.30, speed: 0.20 },
    requires: { technique: 8 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ’§',
    animation: 'kata',
    isKata: true,
    qualityThreshold: 0.70,
  },
  {
    id: 'kata_form3',
    name: 'Kata: Rooted Mountain',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: 'Defensive stance mastery.',
    reps: 1,
    stamina: 35,
    duration: 10,
    gains: { technique: 0.50, endurance: 0.50 },
    requires: { technique: 12 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'â›°ï¸',
    animation: 'kata',
    isKata: true,
    qualityThreshold: 0.70,
  },
  {
    id: 'kata_form4',
    name: 'Kata: Striking Crane',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: 'Precision striking techniques.',
    reps: 1,
    stamina: 40,
    duration: 12,
    gains: { technique: 0.40, speed: 0.10 },
    requires: { technique: 16 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ¦¢',
    animation: 'kata',
    isKata: true,
    qualityThreshold: 0.80,
    unlock: 'precise_strike',
  },
  {
    id: 'kata_form5',
    name: 'Kata: Hidden Dragon',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: 'Master kata combining all five forms.',
    reps: 1,
    stamina: 50,
    duration: 15,
    gains: { technique: 1.00 },
    requires: { technique: 20 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ‰',
    animation: 'kata',
    isKata: true,
    qualityThreshold: 0.85,
  },
  {
    id: 'combo_practice',
    name: 'Combo Practice',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: 'String together 10-hit combos on a dummy.',
    reps: 10,
    stamina: 60,
    duration: 8,
    gains: { technique: 0.25 },
    requires: { technique: 20 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 1,
    icon: 'ðŸ‘Š',
    animation: 'combo',
  },
  {
    id: 'precision_target',
    name: 'Precision Target Practice',
    cat: TRAIN_CAT.TECHNIQUE,
    desc: 'Strike marked spots on a dummy.',
    reps: 20,
    stamina: 20,
    duration: 6,
    gains: { technique: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 1,
    icon: 'ðŸŽ¯',
    animation: 'punch',
  },

  // ========================
  // KI TRAINING
  // ========================

  {
    id: 'meditation_basic',
    name: 'Basic Meditation',
    cat: TRAIN_CAT.KI,
    desc: 'Calm the mind and feel your inner energy.',
    reps: 1,
    stamina: -20,  // negative = restore stamina
    duration: 8,
    gains: { kiControl: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 1,
    icon: 'ðŸ§˜',
    animation: 'meditate',
    staminaRestore: 20,
  },
  {
    id: 'meditation_deep',
    name: 'Deep Meditation',
    cat: TRAIN_CAT.KI,
    desc: 'Enter a deep meditative state for Ki growth.',
    reps: 1,
    stamina: -50,
    duration: 15,
    gains: { kiControl: 0.15 },
    requires: { kiControl: 5 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ§˜',
    animation: 'meditate',
    staminaRestore: 50,
  },
  {
    id: 'meditation_transcendent',
    name: 'Transcendent Meditation',
    cat: TRAIN_CAT.KI,
    desc: 'Reach perfect stillness. Full stamina restore.',
    reps: 1,
    stamina: -100,
    duration: 30,
    gains: { kiControl: 0.30 },
    requires: { kiControl: 20 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0,
    unlockAct: 3,
    icon: 'âœ¨',
    animation: 'meditate',
    staminaRestore: 100,
  },
  {
    id: 'ki_circulation',
    name: 'Ki Circulation',
    cat: TRAIN_CAT.KI,
    desc: 'Guide ki energy through your body.',
    reps: 1,
    stamina: 25,
    duration: 8,
    gains: { kiControl: 0.10 },
    requires: { kiControl: 3 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'âš¡',
    animation: 'kicharge',
  },
  {
    id: 'ki_blast_practice',
    name: 'Ki Blast Practice',
    cat: TRAIN_CAT.KI,
    desc: 'Fire 20 ki blasts at targets.',
    reps: 20,
    stamina: 40,
    duration: 8,
    gains: { kiControl: 0.20 },
    requires: { kiControl: 8 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ’¥',
    animation: 'kiblast',
  },
  {
    id: 'kamehameha_charge',
    name: 'Kamehameha Charging',
    cat: TRAIN_CAT.KI,
    desc: 'Practice holding max Kamehameha charge.',
    reps: 10,
    stamina: 60,
    duration: 10,
    gains: { kiControl: 0.30 },
    requires: { kiControl: 20, powerLevel: 60 },
    tier: TRAIN_TIER.EXTREME,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸŒŠ',
    animation: 'kamehameha',
  },

  // ========================
  // HYBRID TRAINING
  // ========================

  {
    id: 'swimming_laps',
    name: 'Swimming Laps (500m)',
    cat: TRAIN_CAT.HYBRID,
    desc: 'Full pool swimming for all-around fitness.',
    reps: 500,
    stamina: 40,
    duration: 12,
    gains: { speed: 0.10, endurance: 0.15 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 1,
    icon: 'ðŸŠ',
    animation: 'swim',
  },
  {
    id: 'rock_climbing',
    name: 'Rock Climbing (50m)',
    cat: TRAIN_CAT.HYBRID,
    desc: 'Scale a natural cliff face.',
    reps: 50,
    stamina: 45,
    duration: 10,
    gains: { strength: 0.15, endurance: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0.05,
    unlockAct: 0,
    icon: 'ðŸ§—',
    animation: 'climb',
  },
  {
    id: 'milk_delivery',
    name: 'Milk Delivery Run',
    cat: TRAIN_CAT.HYBRID,
    desc: 'Carry milk jugs 5km every morning.',
    reps: 5000,  // meters
    stamina: 60,
    duration: 20,
    gains: { endurance: 0.30, speed: 0.20, strength: 0.10 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ¥›',
    animation: 'carry',
    isRoshiTraining: true,
  },
  {
    id: 'turtle_shell_run',
    name: 'Turtle Shell Running',
    cat: TRAIN_CAT.HYBRID,
    desc: 'Run 1km while wearing the heavy turtle shell.',
    reps: 1000,
    stamina: 60,
    duration: 15,
    gains: { endurance: 0.20, strength: 0.15 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ¢',
    animation: 'run',
    isRoshiTraining: true,
  },
  {
    id: 'combat_flow',
    name: 'Combat Flow Training',
    cat: TRAIN_CAT.HYBRID,
    desc: 'Blend kata and controlled sparring.',
    reps: 1,
    stamina: 70,
    duration: 15,
    gains: { technique: 0.15, speed: 0.10, endurance: 0.10 },
    requires: { technique: 10 },
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 2,
    icon: 'ðŸ¥‹',
    animation: 'kata',
  },

  // ========================
  // RECOVERY / ACTIVE REST
  // ========================

  {
    id: 'stretching',
    name: 'Stretching',
    cat: TRAIN_CAT.RECOVERY,
    desc: 'Light stretching to prevent injury and improve flexibility.',
    reps: 1,
    stamina: -15,
    duration: 5,
    gains: {},
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ¤¸',
    animation: 'stretch',
    staminaRestore: 15,
    injuryReduction: 0.15,
    flexBonus: true,
  },
  {
    id: 'breathing_exercise',
    name: 'Breathing Exercises',
    cat: TRAIN_CAT.RECOVERY,
    desc: 'Controlled breathing to restore energy.',
    reps: 1,
    stamina: -25,
    duration: 8,
    gains: { kiControl: 0.05 },
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ’¨',
    animation: 'breathe',
    staminaRestore: 25,
  },
  {
    id: 'rest_sleep',
    name: 'Rest (Full Sleep)',
    cat: TRAIN_CAT.RECOVERY,
    desc: 'Full night sleep. Recovers all injuries over time.',
    reps: 1,
    stamina: -100,
    duration: 30,
    gains: {},
    requires: null,
    tier: TRAIN_TIER.BASIC,
    injuryRisk: 0,
    unlockAct: 0,
    icon: 'ðŸ˜´',
    animation: 'sleep',
    staminaRestore: 100,
    fullHeal: true,
    injuryTimer: 3600,
  },
];

// Index by ID
const EXERCISE_BY_ID = {};
for (const ex of TRAINING_EXERCISES) {
  EXERCISE_BY_ID[ex.id] = ex;
}

// Get exercises by category
function getExercisesByCategory(cat) {
  return TRAINING_EXERCISES.filter(e => e.cat === cat);
}

// Get exercises available given player stats
function getAvailableExercises(statsSystem, act = 0) {
  return TRAINING_EXERCISES.filter(ex => {
    if (ex.unlockAct > act) return false;
    if (!ex.requires) return true;
    for (const [stat, val] of Object.entries(ex.requires)) {
      if (stat.startsWith('proficiency_')) {
        const profId = stat.replace('proficiency_', '');
        if (statsSystem.getProficiencyLevel(profId) < val) return false;
      } else if (stat === 'powerLevel') {
        if (statsSystem.powerLevel < val) return false;
      } else {
        if ((statsSystem[stat] || 0) < val) return false;
      }
    }
    return true;
  });
}
